(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subPackages/myCar/myCar"],{1425:function(e,t,r){"use strict";(function(e){r("921c");n(r("66fd"));var t=n(r("cf78"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("543d")["createPage"])},5288:function(e,t,r){"use strict";r.r(t);var n=r("8ec7"),a=r.n(n);for(var i in n)"default"!==i&&function(e){r.d(t,e,(function(){return n[e]}))}(i);t["default"]=a.a},"6d48":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return n}));var n={uImage:function(){return r.e("uview-ui/components/u-image/u-image").then(r.bind(null,"7f81"))},uIcon:function(){return r.e("uview-ui/components/u-icon/u-icon").then(r.bind(null,"44ae"))},uLine:function(){return r.e("uview-ui/components/u-line/u-line").then(r.bind(null,"a939"))},uPopup:function(){return r.e("uview-ui/components/u-popup/u-popup").then(r.bind(null,"5010"))},uLoading:function(){return r.e("uview-ui/components/u-loading/u-loading").then(r.bind(null,"3b0b"))},uModal:function(){return r.e("uview-ui/components/u-modal/u-modal").then(r.bind(null,"19c7"))}},a=function(){var e=this,t=e.$createElement;e._self._c},i=[]},"8ec7":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{upload:!0,carInfo:"",show:!1,show2:!1,errMsg:"",driver:!0,carList:[],baiduToken:""}},onShow:function(){this.getCar()},onLoad:function(){this.getDriver()},methods:{getToken:function(){var e=this;this.$u.api.getBaiduAccessToken().then((function(t){e.baiduToken=t.access_token}))},chooseImage:function(){var t=this;e.chooseImage({count:1,sizeType:["original"],success:function(r){t.show=!0,e.showLoading({title:"正在识别..."});var n=r.tempFilePaths[0];e.getFileSystemManager().readFile({filePath:n,encoding:"base64",success:function(e){t.$u.api.baiduOCR({image:"data:image/jpeg;base64,"+e.data,token:t.baiduToken}).then((function(e){t.driver=e["words_result"],t.carNumber=e["words_result"]["号牌号码"]["words"],t.carModel=e["words_result"]["车辆类型"]["words"],t.vehicleFrame=e["words_result"]["车辆识别代号"]["words"],t.saveDriver()}))}})}})},setDefaultCar:function(t){var r=this;1!=t.status&&this.$u.api.saveCar({userId:e.getStorageSync("userId"),carId:t.id,status:1}).then((function(t){if(t){e.setStorageSync("carModel",r.carModel),e.setStorageSync("carNumber",r.carNumber),e.setStorageSync("vehicleFrame",r.vehicleFrame),e.showToast({title:"设置成功"});var n=r;setTimeout((function(){n.getCar()}),1500)}else e.showToast({title:"设置失败，请重试",icon:"none"})}))},saveDriver:function(){var t=this;this.$u.api.saveDriver({userId:e.getStorageSync("userId"),name:this.driver["所有人"]["words"],carNumber:this.driver["号牌号码"]["words"],carModel:this.driver["车辆类型"]["words"],carBrand:this.driver["品牌型号"]["words"],fdjNumber:this.driver["发动机号码"]["words"],carSbNumber:this.driver["车辆识别代号"]["words"]}).then((function(e){e.message&&e.message.indexOf("认证")>=0?(t.show=!1,t.errMsg=e.message,t.show2=!0):t.saveNewCar()}))},getDriver:function(){var e=this;this.$u.api.getDriver().then((function(t){t?e.upload=!0:(e.upload=!1,e.getToken())}))},saveNewCar:function(){var t=this;this.$u.api.saveCar({userId:e.getStorageSync("userId"),carNumber:this.carNumber,vehicleFrame:this.vehicleFrame,carModel:this.carModel,status:1}).then((function(r){if(t.show=!1,r){var n=t;e.setStorageSync("carModel",t.carModel),e.setStorageSync("carNumber",t.carNumber),e.setStorageSync("vehicleFrame",t.vehicleFrame),e.showToast({title:"添加成功",success:function(){n.upload||n.getDriver(),n.getCar()}})}else console.log(r),e.showToast({title:"添加失败，请重试",icon:"none"})}))},getCar:function(){var t=this;this.$u.api.getCar().then((function(r){t.carList=r;for(var n=0;n<r.length;n++){var a=r[n];1==a.status&&(e.setStorageSync("carModel",a.carModel),e.setStorageSync("carNumber",a.carNumber),e.setStorageSync("vehicleFrame",a.vehicleFrame))}}))},editCar:function(t){e.navigateTo({url:"/subPackages/myCar/addCar/addCar?data="+JSON.stringify(t)})},delCar:function(t){var r=this;this.$u.api.delCar({carId:t.id}).then((function(t){t?(r.getCar(),e.removeStorageSync("carModel"),e.removeStorageSync("carNumber"),e.removeStorageSync("vehicleFrame"),e.showToast({title:"删除成功"})):e.showToast({title:"删除失败,请重试"})}))}}};t.default=r}).call(this,r("543d")["default"])},cf78:function(e,t,r){"use strict";r.r(t);var n=r("6d48"),a=r("5288");for(var i in a)"default"!==i&&function(e){r.d(t,e,(function(){return a[e]}))}(i);r("e682");var o,u=r("f0c5"),s=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);t["default"]=s.exports},e682:function(e,t,r){"use strict";var n=r("eaab"),a=r.n(n);a.a},eaab:function(e,t,r){}},[["1425","common/runtime","common/vendor"]]]);