(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subPackages/pay/pay"],{140:
/*!***************************************************************************************************!*\
  !*** C:/Users/GuiYang/Desktop/uniapp/project/consumer/main.js?{"page":"subPackages%2Fpay%2Fpay"} ***!
  \***************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";(function(e){n(/*! uni-pages */4);o(n(/*! vue */2));var t=o(n(/*! ./subPackages/pay/pay.vue */141));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},141:
/*!********************************************************************************!*\
  !*** C:/Users/GuiYang/Desktop/uniapp/project/consumer/subPackages/pay/pay.vue ***!
  \********************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var o=n(/*! ./pay.vue?vue&type=template&id=2f44fc61&scoped=true& */142),i=n(/*! ./pay.vue?vue&type=script&lang=js& */144);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n(/*! ./pay.vue?vue&type=style&index=0&id=2f44fc61&lang=scss&scoped=true& */146);var a,u=n(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */10),c=Object(u["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,"2f44fc61",null,!1,o["components"],a);c.options.__file="subPackages/pay/pay.vue",t["default"]=c.exports},142:
/*!***************************************************************************************************************************!*\
  !*** C:/Users/GuiYang/Desktop/uniapp/project/consumer/subPackages/pay/pay.vue?vue&type=template&id=2f44fc61&scoped=true& ***!
  \***************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,n){"use strict";n.r(t);var o=n(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=template&id=2f44fc61&scoped=true& */143);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},143:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/GuiYang/Desktop/uniapp/project/consumer/subPackages/pay/pay.vue?vue&type=template&id=2f44fc61&scoped=true& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return i})),n.d(t,"staticRenderFns",(function(){return a})),n.d(t,"recyclableRender",(function(){return r})),n.d(t,"components",(function(){return o}));try{o={uInput:function(){return Promise.all(/*! import() | uview-ui/components/u-input/u-input */[n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,/*! @/uview-ui/components/u-input/u-input.vue */620))},uCountTo:function(){return n.e(/*! import() | uview-ui/components/u-count-to/u-count-to */"uview-ui/components/u-count-to/u-count-to").then(n.bind(null,/*! @/uview-ui/components/u-count-to/u-count-to.vue */659))},uGap:function(){return n.e(/*! import() | uview-ui/components/u-gap/u-gap */"uview-ui/components/u-gap/u-gap").then(n.bind(null,/*! @/uview-ui/components/u-gap/u-gap.vue */515))},uIcon:function(){return n.e(/*! import() | uview-ui/components/u-icon/u-icon */"uview-ui/components/u-icon/u-icon").then(n.bind(null,/*! @/uview-ui/components/u-icon/u-icon.vue */501))},uLine:function(){return n.e(/*! import() | uview-ui/components/u-line/u-line */"uview-ui/components/u-line/u-line").then(n.bind(null,/*! @/uview-ui/components/u-line/u-line.vue */550))},uButton:function(){return n.e(/*! import() | uview-ui/components/u-button/u-button */"uview-ui/components/u-button/u-button").then(n.bind(null,/*! @/uview-ui/components/u-button/u-button.vue */543))},uMask:function(){return n.e(/*! import() | uview-ui/components/u-mask/u-mask */"uview-ui/components/u-mask/u-mask").then(n.bind(null,/*! @/uview-ui/components/u-mask/u-mask.vue */613))},uImage:function(){return n.e(/*! import() | uview-ui/components/u-image/u-image */"uview-ui/components/u-image/u-image").then(n.bind(null,/*! @/uview-ui/components/u-image/u-image.vue */522))}}}catch(u){if(-1===u.message.indexOf("Cannot find module")||-1===u.message.indexOf(".vue"))throw u;console.error(u.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var e=this,t=e.$createElement,n=(e._self._c,0==e.payType?e.getPrice():null),o=0==e.payType?e.getPrice():null;e.$mp.data=Object.assign({},{$root:{m0:n,m1:o}})},r=!1,a=[];i._withStripped=!0},144:
/*!*********************************************************************************************************!*\
  !*** C:/Users/GuiYang/Desktop/uniapp/project/consumer/subPackages/pay/pay.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var o=n(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=script&lang=js& */145),i=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=i.a},145:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/GuiYang/Desktop/uniapp/project/consumer/subPackages/pay/pay.vue?vue&type=script&lang=js& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n(/*! ../../common/config.js */41)),i=r(n(/*! uview-ui/libs/function/md5 */97));function r(e){return e&&e.__esModule?e:{default:e}}function a(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=o?Object.getOwnPropertyDescriptor(e,i):null;r&&(r.get||r.set)?Object.defineProperty(n,i,r):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}var c={data:function(){return{show:!1,customStyle:{fontSize:"40rpx",lineHeight:"40rpx",height:"40rpx",fontWeight:"bold"},list:[{name:"余额",value:"YE"},{name:"微信",value:"WX"}],wallet:0,orderData:{},payType:"",paymentType:"YE",current:0,youhui:0,zige:!0,startValue:Math.round(100*(30*Math.random()+5))/100,change:!1,kaiguan:"off"}},onShow:function(){this.getWaletDetail()},onLoad:function(e){this.payType=e.payType,0==e.payType&&this.getDiscount(),2==e.payType&&this.getOrderDetail(e.orderId),this.orderData=e},methods:{getPrice:function(){return"on"==this.kaiguan&&this.zige&&this.change?this.orderData.commodityPrice>this.youhui?this.orderData.commodityPrice-this.youhui:(this.list[1]["disabled"]=!0,0):this.orderData.commodityPrice},getDiscount:function(){var e=this;this.$u.api.getDiscount().then((function(t){"on"==t.kaiguan&&(e.kaiguan=t.kaiguan,e.youhui=t.youhui,e.zige=t.zige,t.zige&&e.$refs.uCountTo.start())}))},changePrice:function(){this.change=!0},get:function(){o.getSubscribeMessage()},getOrderDetail:function(e){var t=this;this.$u.api.getOrderDetail({orderId:e}).then((function(e){t.orderData=JSON.parse(e)}))},charge:function(){e.navigateTo({url:"/pages/charge/charge?flag=1"})},radioChange:function(e){this.paymentType=e.detail.value},getWaletDetail:function(){var e=this;this.$u.api.getWaletDetail().then((function(t){e.wallet=t.totalAmount,e.wallet>e.orderData.orderMoney||e.wallet>e.orderData.commodityPrice?(e.current=0,e.paymentType="YE"):(e.current=1,e.paymentType="WX")}))},submit:function(){var t=this,n=this;if(this.paymentType)if("YE"==this.paymentType&&(this.wallet<this.orderData.commodityPrice||this.wallet<this.orderData.orderMoney))e.showToast({title:"余额不足，请充值，或者使用微信支付",icon:"none"});else{if(0==this.payType&&this.$u.api.createOrder({userId:e.getStorageSync("userId"),shopId:this.orderData.shopId,merchantId:this.orderData.merchantId,commodityId:this.orderData.commodityId,commodityPrice:this.getPrice(),carNumber:this.orderData.carNumber,carModel:this.orderData.carModel,userPhone:this.orderData.userPhone,scheduledTime:this.orderData.scheduledTime,orderType:this.orderData.orderType,paymentType:this.paymentType,openId:e.getStorageSync("openid"),orderRemark:this.orderData.orderRemark,discount:"on"==this.kaiguan&&this.zige?1:0,money:this.orderData.commodityPrice}).then((function(r){var a=r.orderId;if("WX"==t.paymentType){var u=o.WX_appId,c=o.getNum(),s="prepay_id="+r.prepayid,d="MD5",p=Date.parse(new Date).toString(),l=o.key,y=i.default.md5("appId="+u+"&nonceStr="+c+"&package="+s+"&signType="+d+"&timeStamp="+p+"&key="+l);wx.requestPayment({timeStamp:p,nonceStr:c,package:s,signType:d,paySign:y,success:function(){n.show=!0;var t=function(){setTimeout((function(){e.redirectTo({url:"/subPackages/booking/bookingDetail/bookingDetail?orderId="+a})}),1500)};o.getSubscribeMessage(t)},complete:function(e){console.log(e)}})}if("YE"==t.paymentType){if(500==r.code)return void e.showToast({title:r.message,icon:"none"});n.show=!0;var g=function(){setTimeout((function(){e.redirectTo({url:"/subPackages/booking/bookingDetail/bookingDetail?orderId="+a})}),1500)};o.getSubscribeMessage(g)}})),1==this.payType&&this.$u.api.paymentOrder({orderId:this.orderData.orderId,openId:e.getStorageSync("openid"),paymentType:this.paymentType}).then((function(r){var a=r.orderId;if("WX"==t.paymentType){var u=o.WX_appId,c=o.getNum(),s="prepay_id="+r.prepayid,d="MD5",p=Date.parse(new Date).toString(),l=o.key,y=i.default.md5("appId="+u+"&nonceStr="+c+"&package="+s+"&signType="+d+"&timeStamp="+p+"&key="+l);wx.requestPayment({timeStamp:p,nonceStr:c,package:s,signType:d,paySign:y,success:function(t){n.show=!0;var i=function(){setTimeout((function(){e.redirectTo({url:"/subPackages/booking/bookingDetail/bookingDetail?orderId="+a})}),1500)};o.getSubscribeMessage(i)},complete:function(e){console.log(e)}})}if("YE"==t.paymentType){n.show=!0;var g=function(){setTimeout((function(){e.redirectTo({url:"/subPackages/booking/bookingDetail/bookingDetail?orderId="+a})}),1500)};o.getSubscribeMessage(g)}})),2==this.payType){if("WX"==this.paymentType){var r=this.orderData.id,a=o.WX_appId,u=o.getNum(),c="prepay_id="+this.orderData.prepayId,s="MD5",d=Date.parse(new Date).toString(),p=o.key,l=i.default.md5("appId="+a+"&nonceStr="+u+"&package="+c+"&signType="+s+"&timeStamp="+d+"&key="+p);wx.requestPayment({timeStamp:d,nonceStr:u,package:c,signType:s,paySign:l,success:function(){n.show=!0;var t=function(){setTimeout((function(){e.redirectTo({url:"/subPackages/booking/bookingDetail/bookingDetail?orderId="+r})}),1500)};o.getSubscribeMessage(t)},fail:function(t){(new Date).getTime()-n.orderData.createTime>72e5?(e.showLoading({title:"订单支付超时",duration:3e3}),n.$u.api.setOrderStatus({orderId:n.orderData.id,status:"FAIL"}).then((function(t){setTimeout((function(){e.hideLoading(),e.navigateBack()}),1e3)}))):e.showToast({icon:"none",title:"请重新发起支付"})},complete:function(e){}})}"YE"==this.paymentType&&this.$u.api.paymentOrder({orderId:this.orderData.id,openId:e.getStorageSync("openid"),paymentType:this.paymentType}).then((function(o){"YE"==t.paymentType&&(n.show=!0,setTimeout((function(){e.redirectTo({url:"/subPackages/booking/bookingDetail/bookingDetail?orderId="+o.orderId})}),1500))}))}3==this.payType&&this.$u.api.payRescueOrder({orderId:this.orderData.orderId,openId:e.getStorageSync("openid"),paymentType:this.paymentType}).then((function(r){r.orderId;if("WX"==t.paymentType){var a=o.WX_appId,u=o.getNum(),c="prepay_id="+r.prepayid,s="MD5",d=Date.parse(new Date).toString(),p=o.key,l=i.default.md5("appId="+a+"&nonceStr="+u+"&package="+c+"&signType="+s+"&timeStamp="+d+"&key="+p);wx.requestPayment({timeStamp:d,nonceStr:u,package:c,signType:s,paySign:l,success:function(t){console.log(t),n.show=!0;var i=function(){setTimeout((function(){e.redirectTo({url:"/subPackages/rescue/rescue"})}),1500)};o.getSubscribeMessage(i)},complete:function(e){console.log(e)}})}if("YE"==t.paymentType){n.show=!0;var y=function(){setTimeout((function(){e.redirectTo({url:"/subPackages/rescue/rescue"})}),1500)};o.getSubscribeMessage(y)}}))}else e.showToast({title:"请选择支付方式",icon:"none"})}}};t.default=c}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},146:
/*!******************************************************************************************************************************************!*\
  !*** C:/Users/GuiYang/Desktop/uniapp/project/consumer/subPackages/pay/pay.vue?vue&type=style&index=0&id=2f44fc61&lang=scss&scoped=true& ***!
  \******************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var o=n(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=style&index=0&id=2f44fc61&lang=scss&scoped=true& */147),i=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=i.a},147:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/GuiYang/Desktop/uniapp/project/consumer/subPackages/pay/pay.vue?vue&type=style&index=0&id=2f44fc61&lang=scss&scoped=true& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){}},[[140,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subPackages/pay/pay.js.map