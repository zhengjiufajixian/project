(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/orderDetail/orderDetail"],{"14e2":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{imgList1:[],imgList2:[],orderDetail:{orderStatus:"",replyList:[],commodityPrice:0,orderMoney:0,id:""},orderId:"",value:0,appraise:"",fz30:{fontSize:"30rpx"},show:!1,content:"建议您上传作业图片，再确认收款！"}},onShow:function(){this.getOrderDetail()},onLoad:function(e){this.orderId=e.orderId},methods:{handleCall:function(){e.makePhoneCall({phoneNumber:this.orderDetail.userPhone})},confirm:function(){var t=this,r="SUCCESS";this.$u.api.setOrderStatus({orderId:this.orderDetail.id,status:r}).then((function(r){if(r.indexOf("成功")){e.showToast({title:"收款成功"});var i=t;setTimeout((function(){i.getOrderDetail()}),1500)}}))},addImgList1:function(e,t,r,i){this.imgList1.push(e)},removeImgList1:function(e,t,r){var i=this.imgList1;i.splice(e,1),this.imgList1=i},addImgList2:function(e,t,r,i){this.imgList2.push(e)},removeImgList2:function(e,t,r){var i=this.imgList2;i.splice(e,1),this.imgList2=i},getOrderDetail:function(){var e=this;this.$u.api.getOrderDetail({orderId:this.orderId}).then((function(t){var r=JSON.parse(t);if(e.orderDetail=r,r.maintainRemark&&(e.orderDetail.maintainRemark=JSON.parse(r.maintainRemark)),r.workBeforeImg&&(e.imgList1=JSON.parse(r.workBeforeImg)),r.workAfterImg&&(e.imgList2=JSON.parse(r.workAfterImg)),e.appraise=r.appraise,r.appraise&&r.appraise.img&&(e.appraise.img=JSON.parse(r.appraise.img)),r.replyList)for(var i=0;i<r.replyList.length;i++)r.replyList[i].img&&(r.replyList[i].img=JSON.parse(r.replyList[i].img));e.orderDetail=r}))},previewImage:function(e,t){wx.previewImage({current:e,urls:t})},getOrderStatus:function(e){switch(e.orderStatus){case"INIT":return"XC"==e.orderType?"未支付":"已预约";case"WAITCONFIRM":return"XC"==e.orderType?"待确认":"待完善";case"PAYOFF":return"待支付";case"EXECUTING":return"服务中";case"SUCCESS":return"已完成";case"FAIL":return"已取消";case"REFUND":return"已退款";default:return""}},getBtnText:function(){var e=this.orderDetail;switch(e.orderStatus){case"INIT":return"XC"==e.orderType?"":"确认接单";case"WAITCONFIRM":return"XC"==e.orderType?"确认接单":"完善订单";case"PAYOFF":return"待支付";case"EXECUTING":return"确认收款";case"SUCCESS":return 1==e.refund?"已申请退款":0==e.evaluate?"待评价":"去回复";case"REFUND":return"已退款";case"FAIL":return"已取消";default:return""}},getBtnClick:function(){var t=this,r=this.orderDetail;if("XC"==r.orderType){if("WAITCONFIRM"==r.orderStatus){var i="EXECUTING";this.$u.api.setOrderStatus({orderId:r.id,status:i}).then((function(r){if(r.indexOf("成功")){e.showToast({title:"接单成功"});var i=t;setTimeout((function(){i.getOrderDetail()}),1500)}}))}"EXECUTING"==r.orderStatus&&(r.workAfterImg&&r.workBeforeImg&&JSON.parse(r.workAfterImg).length>0&&JSON.parse(r.workBeforeImg).length>0?this.confirm():this.show=!0),"SUCCESS"==r.orderStatus&&(0==r.evaluate&&e.showToast({title:"等待用户评价",icon:"none"}),1==r.evaluate&&e.navigateTo({url:"/pages/order/reply/reply?orderId="+r.id})),"FEFUND"==r.orderStatus&&e.showToast({title:"订单已退款",icon:"none"}),"FAIL"==r.orderStatus&&e.showToast({title:"订单已取消",icon:"none"})}else{if("INIT"==r.orderStatus){var n="WAITCONFIRM";this.$u.api.setOrderStatus({orderId:r.id,status:n}).then((function(r){if(console.log(r.indexOf("成功")),r.indexOf("成功")){e.showToast({title:"接单成功"});var i=t;setTimeout((function(){i.getOrderDetail()}),1500)}}))}"WAITCONFIRM"==r.orderStatus&&e.navigateTo({url:"/pages/order/orderDetail/payBookingOrder/payBookingOrder?orderId="+r.id}),"PAYOFF"==r.orderStatus&&e.showToast({title:"等待客户支付",icon:"none"}),"EXECUTING"==r.orderStatus&&(r.workAfterImg&&r.workBeforeImg&&JSON.parse(r.workAfterImg).length>0&&JSON.parse(r.workBeforeImg).length>0?this.confirm():this.show=!0),"SUCCESS"==r.orderStatus&&(0==r.evaluate&&e.showToast({title:"等待用户评价",icon:"none"}),1==r.evaluate&&e.navigateTo({url:"/pages/order/reply/reply?orderId="+r.id})),"FAIL"==r.orderStatus&&e.showToast({title:"订单已取消",icon:"none"})}}}};t.default=r}).call(this,r("543d")["default"])},"3e3a":function(e,t,r){"use strict";var i=r("4e26"),n=r.n(i);n.a},"44da":function(e,t,r){"use strict";(function(e){r("7ade");i(r("66fd"));var t=i(r("6cb4"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("543d")["createPage"])},"4e26":function(e,t,r){},"53f1":function(e,t,r){"use strict";r.r(t);var i=r("14e2"),n=r.n(i);for(var a in i)"default"!==a&&function(e){r.d(t,e,(function(){return i[e]}))}(a);t["default"]=n.a},"6cb4":function(e,t,r){"use strict";r.r(t);var i=r("b8e9"),n=r("53f1");for(var a in n)"default"!==a&&function(e){r.d(t,e,(function(){return n[e]}))}(a);r("3e3a");var o,u=r("f0c5"),s=Object(u["a"])(n["default"],i["b"],i["c"],!1,null,"373be8ca",null,!1,i["a"],o);t["default"]=s.exports},b8e9:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i}));var i={uGap:function(){return r.e("uview-ui/components/u-gap/u-gap").then(r.bind(null,"94c1"))},uLine:function(){return r.e("uview-ui/components/u-line/u-line").then(r.bind(null,"ee2f"))},uRate:function(){return r.e("uview-ui/components/u-rate/u-rate").then(r.bind(null,"6e20"))},uImage:function(){return r.e("uview-ui/components/u-image/u-image").then(r.bind(null,"412e"))},uModal:function(){return r.e("uview-ui/components/u-modal/u-modal").then(r.bind(null,"4212"))}},n=function(){var e=this,t=e.$createElement,r=(e._self._c,e.getOrderStatus(e.orderDetail)),i=e.$u.timeFormat(new Date(e.orderDetail.createTime).getTime(),"yyyy-mm-dd hh:MM"),n=e.orderDetail.scheduledTime?e.$u.timeFormat(new Date(e.orderDetail.scheduledTime).getTime(),"yyyy-mm-dd"):null,a="INIT"!=e.orderDetail.orderStatus&&"WAITCONFIRM"!=e.orderDetail.orderStatus&&"PAYOFF"!=e.orderDetail.orderStatus?JSON.stringify(e.orderDetail):null,o=e.orderDetail.orderStatus?e.getBtnText(e.orderDetail):null;e.$mp.data=Object.assign({},{$root:{m0:r,g0:i,g1:n,g2:a,m1:o}})},a=[]}},[["44da","common/runtime","common/vendor"]]]);